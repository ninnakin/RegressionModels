n[-"transm"]
n[-transm]
n
n[transm]
n["transm"]
n[n=="transm"]
n[!n=="transm"]
n<-names(mtcars)
sapply(n[!n=="transm"], function(x) cor(mtcars$wt, as.numeric(mtcars[,x] )))
sapply(n[!n==c("transm","wt")], function(x) cor(mtcars$wt, as.numeric(mtcars[,x] )))
sapply(n[!n=="transm" & !n=="wt"], function(x) cor(mtcars$wt, as.numeric(mtcars[,x] )))
wt_cor <- sapply(n[!n=="transm" & !n=="wt"], function(x) cor(mtcars$wt, as.numeric(mtcars[,x] )))
wt_cor
library(gridExtra)
# disp
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+geom_point(size=3)
# hp
g2 <- ggplot(data=mtcars,aes(x=hp, y=mpg, color=transm))+geom_point(size=3)
# drat
g3 <- ggplot(data=mtcars,aes(x=drat, y=mpg, color=transm))+geom_point(size=3)
# qsec
g4 <- ggplot(data=mtcars,aes(x=qsec, y=mpg, color=transm))+geom_point(size=3)
# gear
g5 <- ggplot(data=mtcars,aes(x=gear, y=mpg, color=transm))+geom_point(size=3)
# carb
g6 <- ggplot(data=mtcars,aes(x=carb, y=mpg, color=transm))+geom_point(size=3)
grid.arrange(g1, g2, g3, g4, g5, g6, row=2, col=3)
# disp
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+geom_point(size=3)
# hp
g2 <- ggplot(data=mtcars,aes(x=hp, y=mpg, color=transm))+geom_point(size=3)
# drat
g3 <- ggplot(data=mtcars,aes(x=drat, y=mpg, color=transm))+geom_point(size=3)
# qsec
g4 <- ggplot(data=mtcars,aes(x=qsec, y=mpg, color=transm))+geom_point(size=3)
# gear
g5 <- ggplot(data=mtcars,aes(x=gear, y=mpg, color=transm))+geom_point(size=3)
# carb
g6 <- ggplot(data=mtcars,aes(x=carb, y=mpg, color=transm))+geom_point(size=3)
grid.arrange(g1, g2, g3, g4, g5, g6)
grid.arrange(g1, g2, g3, g4, g5, g6, rows=2)
grid.arrange(g1, g2, g3, g4, g5, g6)
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+geom_point(size=3)+theme(legend.position="none")
# hp
g2 <- ggplot(data=mtcars,aes(x=hp, y=mpg, color=transm))+geom_point(size=3)+theme(legend.position="none")
# drat
g3 <- ggplot(data=mtcars,aes(x=drat, y=mpg, color=transm))+geom_point(size=3)+theme(legend.position="none")
# qsec
g4 <- ggplot(data=mtcars,aes(x=qsec, y=mpg, color=transm))+geom_point(size=3)+theme(legend.position="none")
# gear
g5 <- ggplot(data=mtcars,aes(x=gear, y=mpg, color=transm))+geom_point(size=3)+theme(legend.position="none")
# carb
g6 <- ggplot(data=mtcars,aes(x=carb, y=mpg, color=transm))+geom_point(size=3)+theme(legend.position="none")
grid.arrange(g1, g2, g3, g4, g5, g6)
grid.arrange(g1, g2, g3, g4, g5, g6, ncol=3)
ct_cor
wt_cor
wt_cor[disp]
wt_cor["disp"]
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+geom_point(size=3)+theme(legend.position="none")+ggtitle(wt_cor["disp"])
# hp
g2 <- ggplot(data=mtcars,aes(x=hp, y=mpg, color=transm))+geom_point(size=3)+theme(legend.position="none")
# drat
g3 <- ggplot(data=mtcars,aes(x=drat, y=mpg, color=transm))+geom_point(size=3)+theme(legend.position="none")
# qsec
g4 <- ggplot(data=mtcars,aes(x=qsec, y=mpg, color=transm))+geom_point(size=3)+theme(legend.position="none")
# gear
g5 <- ggplot(data=mtcars,aes(x=gear, y=mpg, color=transm))+geom_point(size=3)+theme(legend.position="none")
# carb
g6 <- ggplot(data=mtcars,aes(x=carb, y=mpg, color=transm))+geom_point(size=3)+theme(legend.position="none")
grid.arrange(g1, g2, g3, g4, g5, g6, ncol=3)
wt_cor <- sapply(n[!n=="transm" & !n=="wt"], function(x) round(cor(mtcars$wt, as.numeric(mtcars[,x] )),2))
wt_cor
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+geom_point(size=3)+theme(legend.position="none")+ggtitle("Correlation with weight: " ,wt_cor["disp"])
color=transm))+geom_point(size=3)+theme(legend.position="none")+ggtitle(paste("Correlation with weight:", wt_cor["disp"]))
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+geom_point(size=3)+theme(legend.position="none")+ggtitle(paste("Correlation with weight:", wt_cor["disp"]))
g1
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+ plot_style +
ggtitle(paste("Correlation with weight:", wt_cor["disp"]))
# hp
g2 <- ggplot(data=mtcars,aes(x=hp, y=mpg, color=transm))+ plot_style +
ggtitle(paste("Correlation with weight:", wt_cor["hp"]))
# drat
g3 <- ggplot(data=mtcars,aes(x=drat, y=mpg, color=transm))+ plot_style +
ggtitle(paste("Correlation with weight:", wt_cor["drat"]))
# qsec
g4 <- ggplot(data=mtcars,aes(x=qsec, y=mpg, color=transm))+ plot_style +
ggtitle(paste("Correlation with weight:", wt_cor["qsec"]))
# gear
g5 <- ggplot(data=mtcars,aes(x=gear, y=mpg, color=transm))+ plot_style +
ggtitle(paste("Correlation with weight:", wt_cor["gear"]))
# carb
g6 <- ggplot(data=mtcars,aes(x=carb, y=mpg, color=transm))+ plot_style +
ggtitle(paste("Correlation with weight:", wt_cor["carb"]))
grid.arrange(g1, g2, g3, g4, g5, g6, ncol=3)
plot_style <- geom_point(size=3)+theme(legend.position="none")
# disp
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+ plot_style +
ggtitle(paste("Correlation with weight:", wt_cor["disp"]))
# hp
g2 <- ggplot(data=mtcars,aes(x=hp, y=mpg, color=transm))+ plot_style +
ggtitle(paste("Correlation with weight:", wt_cor["hp"]))
# drat
g3 <- ggplot(data=mtcars,aes(x=drat, y=mpg, color=transm))+ plot_style +
ggtitle(paste("Correlation with weight:", wt_cor["drat"]))
# qsec
g4 <- ggplot(data=mtcars,aes(x=qsec, y=mpg, color=transm))+ plot_style +
ggtitle(paste("Correlation with weight:", wt_cor["qsec"]))
# gear
g5 <- ggplot(data=mtcars,aes(x=gear, y=mpg, color=transm))+ plot_style +
ggtitle(paste("Correlation with weight:", wt_cor["gear"]))
# carb
g6 <- ggplot(data=mtcars,aes(x=carb, y=mpg, color=transm))+ plot_style +
ggtitle(paste("Correlation with weight:", wt_cor["carb"]))
grid.arrange(g1, g2, g3, g4, g5, g6, ncol=3)
plot_style <- geom_point(size=3)+theme(legend.position="none")
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+ plot_style +
ggtitle(paste("Correlation with weight:", wt_cor["disp"]))
g1
plot_style <- geom_point(size=3)+theme(legend.position="none")
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+ plot_style +
ggtitle(paste("Correlation with weight:", wt_cor["disp"]))
g1
# disp
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+ plot_style + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["disp"]))
# hp
g2 <- ggplot(data=mtcars,aes(x=hp, y=mpg, color=transm))+ plot_style + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["hp"]))
# drat
g3 <- ggplot(data=mtcars,aes(x=drat, y=mpg, color=transm))+ plot_style + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["drat"]))
# qsec
g4 <- ggplot(data=mtcars,aes(x=qsec, y=mpg, color=transm))+ plot_style + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["qsec"]))
# gear
g5 <- ggplot(data=mtcars,aes(x=gear, y=mpg, color=transm))+ plot_style + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["gear"]))
# carb
g6 <- ggplot(data=mtcars,aes(x=carb, y=mpg, color=transm))+ plot_style + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["carb"]))
grid.arrange(g1, g2, g3, g4, g5, g6, ncol=3)
plot_style <- theme(legend.position="none")
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+ plot_style + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["disp"]))
g1
# disp
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+ plot_style + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["disp"]))
# hp
g2 <- ggplot(data=mtcars,aes(x=hp, y=mpg, color=transm))+ plot_style + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["hp"]))
# drat
g3 <- ggplot(data=mtcars,aes(x=drat, y=mpg, color=transm))+ plot_style + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["drat"]))
# qsec
g4 <- ggplot(data=mtcars,aes(x=qsec, y=mpg, color=transm))+ plot_style + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["qsec"]))
# gear
g5 <- ggplot(data=mtcars,aes(x=gear, y=mpg, color=transm))+ plot_style + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["gear"]))
# carb
g6 <- ggplot(data=mtcars,aes(x=carb, y=mpg, color=transm))+ plot_style + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["carb"]))
grid.arrange(g1, g2, g3, g4, g5, g6, ncol=3)
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+ geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["disp"]))
g1
plot_style <- theme(legend.position="none", plot.title = element_text(lineheight=.8, face="bold"))
# disp
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+ geom_point(size=3)+plot_style+
ggtitle(paste("Correlation with weight:", wt_cor["disp"]))
g1
plot_style <- theme(legend.position="none", plot.title = element_text(lineheight=.8))
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+ geom_point(size=3)+plot_style+
ggtitle(paste("Correlation with weight:", wt_cor["disp"]))
g1
# disp
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+ geom_point(size=3)+plot_theme+
ggtitle(paste("Correlation with weight:", wt_cor["disp"]))
# hp
g2 <- ggplot(data=mtcars,aes(x=hp, y=mpg, color=transm))+ plot_theme + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["hp"]))
# drat
g3 <- ggplot(data=mtcars,aes(x=drat, y=mpg, color=transm))+ plot_theme + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["drat"]))
# qsec
g4 <- ggplot(data=mtcars,aes(x=qsec, y=mpg, color=transm))+ plot_theme + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["qsec"]))
# gear
g5 <- ggplot(data=mtcars,aes(x=gear, y=mpg, color=transm))+ plot_theme + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["gear"]))
# carb
g6 <- ggplot(data=mtcars,aes(x=carb, y=mpg, color=transm))+ plot_theme + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["carb"]))
grid.arrange(g1, g2, g3, g4, g5, g6, ncol=3)
g2 <- ggplot(data=mtcars,aes(x=hp, y=mpg, color=transm))+ plot_theme + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["hp"]))
plot_theme <- theme(legend.position="none", plot.title = element_text(lineheight=.6))
g2 <- ggplot(data=mtcars,aes(x=hp, y=mpg, color=transm))+ plot_theme + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["hp"]))
g2
plot_theme <- theme(legend.position="none", plot.title = element_text(lineheight=.6))
g2 <- ggplot(data=mtcars,aes(x=hp, y=mpg, color=transm))+ plot_theme + geom_point(size=3)
ggtitle(paste("Correlation with weight:", wt_cor["hp"]))
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+ geom_point(size=3)+plot_theme+
ggtitle(paste("Correlation with weight:", wt_cor["disp"]))
g2 <- ggplot(data=mtcars,aes(x=hp, y=mpg, color=transm))+ geom_point(size=3)+plot_theme
ggtitle(paste("Correlation with weight:", wt_cor["hp"]))
# How to check which variables have influence on mpg? plot? check covariance? fit regressions with each?
g1<-ggplot(data=mtcars,aes(x=wt, y=mpg, color=as.factor(cyl)))+geom_point(size=3)+
geom_abline(intercept=summary(fit_wt)$coef[1,1], slope=summary(fit_wt)$coef[2,1], lwd=0.5)
g2<-ggplot(data=mtcars, aes(x=as.factor(cyl), y=mpg, fill=as.factor(cyl)))+geom_boxplot()
g3<-ggplot(data=mtcars,aes(x=wt, y=mpg, color=vs))+geom_point(size=3)+
geom_abline(intercept=summary(fit_wt)$coef[1,1], slope=summary(fit_wt)$coef[2,1], lwd=0.5)
g4<-ggplot(data=mtcars, aes(x=vs, y=mpg, fill=vs))+geom_boxplot()
grid.arrange(g1, g2, g3, g4, ncol=2)
rm(plot_style)
grid.arrange(g2, g1, g4, g3, ncol=2)
# How to check which variables have influence on mpg? plot? check covariance? fit regressions with each?
g1<-ggplot(data=mtcars,aes(x=wt, y=mpg, color=as.factor(cyl)))+geom_point(size=2)+
geom_abline(intercept=summary(fit_wt)$coef[1,1], slope=summary(fit_wt)$coef[2,1], lwd=0.5)+
theme(legend.position="none")
g2<-ggplot(data=mtcars, aes(x=as.factor(cyl), y=mpg, fill=as.factor(cyl)))+geom_boxplot()
g3<-ggplot(data=mtcars,aes(x=wt, y=mpg, color=vs))+geom_point(size=2)+
geom_abline(intercept=summary(fit_wt)$coef[1,1], slope=summary(fit_wt)$coef[2,1], lwd=0.5)+
theme(legend.position="none")
g4<-ggplot(data=mtcars, aes(x=vs, y=mpg, fill=vs))+geom_boxplot()
grid.arrange(g2, g1, g4, g3, ncol=2)
n<-names(mtcars)
wt_cor <- sapply(n[!n=="transm" & !n=="wt"], function(x) round(cor(mtcars$wt, as.numeric(mtcars[,x] )),2))
plot_theme <- theme(legend.position="none", plot.title = element_text(size=8))
# disp
g1 <- ggplot(data=mtcars,aes(x=disp, y=mpg, color=transm))+ geom_point(size=2)+plot_theme+
ggtitle(paste("Correlation with weight:", wt_cor["disp"]))
# hp
g2 <- ggplot(data=mtcars,aes(x=hp, y=mpg, color=transm))+ geom_point(size=2)+plot_theme+
ggtitle(paste("Correlation with weight:", wt_cor["hp"]))
# drat
g3 <- ggplot(data=mtcars,aes(x=drat, y=mpg, color=transm))+ plot_theme + geom_point(size=2)+
ggtitle(paste("Correlation with weight:", wt_cor["drat"]))
# qsec
g4 <- ggplot(data=mtcars,aes(x=qsec, y=mpg, color=transm))+ plot_theme + geom_point(size=2)+
ggtitle(paste("Correlation with weight:", wt_cor["qsec"]))
# gear
g5 <- ggplot(data=mtcars,aes(x=gear, y=mpg, color=transm))+ plot_theme + geom_point(size=2)+
ggtitle(paste("Correlation with weight:", wt_cor["gear"]))
# carb
g6 <- ggplot(data=mtcars,aes(x=carb, y=mpg, color=transm))+ plot_theme + geom_point(size=2)+
ggtitle(paste("Correlation with weight:", wt_cor["carb"]))
grid.arrange(g1, g2, g3, g4, g5, g6, ncol=3)
fit_wt_am <- lm(mpg~wt*am, mtcars)
summary(fit_wt)
summary(fit_wt_am)
anova(fit_wt, fit_wt_am)
fit_all <- lm(mpg~., mtcars)
summary(fit_all)
anova(fit_wt, fit_wt_am, fit_all)
fit_wt_am_all <- lm(mpg~wt*am+., mtcars)
anova(fit_wt, fit_wt_am, fit_all, fit_wt_am_all)
summary(fit_wt_am_all)
anova(fit_wt, fit_wt_am, fit_wt_am_all)
fit_wt_am_choice <- lm(mpg~wt*am+qseq+carb+hp+cyl+vs, mtcars)
fit_wt_am_choice <- lm(mpg~wt*am+qsec+carb+hp+cyl+vs, mtcars)
anova(fit_wt, fit_wt_am, fit_all, fit_wt_am_choice, fit_wt_am_all)
anova(fit_wt, fit_wt_am, fit_wt_am_choice, fit_all, fit_wt_am_all)
fit_wt<-lm(mpg~wt, mtcars)
fit_wt_am <- lm(mpg~wt*am, mtcars)
fit_all <- lm(mpg~., mtcars)
fit_wt_am_choice <- lm(mpg~wt*am+qsec+carb+hp+cyl+vs, mtcars)
fit_wt_am_all <- lm(mpg~wt*am+., mtcars)
anova(fit_wt, fit_wt_am, fit_wt_am_choice, fit_all, fit_wt_am_all)
data("mtcars")
mtcars$am <- as.factor(mtcars$am)
levels(mtcars$am)<-c("Automatic","Manual")
# motor type as factor
mtcars$vs <- as.factor(mtcars$vs)
levels(mtcars$vs)<-c("V","S")
fit_wt<-lm(mpg~wt, mtcars)
fit_wt_am <- lm(mpg~wt*am, mtcars)
fit_all <- lm(mpg~., mtcars)
fit_wt_am_choice <- lm(mpg~wt*am+qsec+carb+hp+cyl+vs, mtcars)
fit_wt_am_all <- lm(mpg~wt*am+., mtcars)
anova(fit_wt, fit_wt_am, fit_wt_am_choice, fit_all, fit_wt_am_all)
anova(fit_wt, fit_wt_am, fit_wt_am_choice, fit_wt_am_all)
fit_wt<-lm(mpg~wt, mtcars)
fit_wt_am <- lm(mpg~wt*am, mtcars)
fit_all <- lm(mpg~., mtcars)
fit_wt_am_choice <- lm(mpg~wt*am+qsec+carb+hp+cyl, mtcars)
fit_wt_am_all <- lm(mpg~wt*am+., mtcars)
anova(fit_wt, fit_wt_am, fit_wt_am_choice, fit_wt_am_all)
fit_wt<-lm(mpg~wt, mtcars)
fit_wt_am <- lm(mpg~wt*am, mtcars)
fit_all <- lm(mpg~., mtcars)
fit_wt_am_choice <- lm(mpg~wt*am+qsec+carb+hp+vs, mtcars)
fit_wt_am_all <- lm(mpg~wt*am+., mtcars)
anova(fit_wt, fit_wt_am, fit_wt_am_choice, fit_wt_am_all)
fit_wt<-lm(mpg~wt, mtcars)
fit_wt_am <- lm(mpg~wt*am, mtcars)
fit_all <- lm(mpg~., mtcars)
fit_wt_am_choice <- lm(mpg~wt*am+qsec+carb+hp, mtcars)
fit_wt_am_all <- lm(mpg~wt*am+., mtcars)
anova(fit_wt, fit_wt_am, fit_wt_am_choice, fit_wt_am_all)
fit_wt<-lm(mpg~wt, mtcars)
fit_wt_am <- lm(mpg~wt*am, mtcars)
fit_all <- lm(mpg~., mtcars)
fit_wt_am_choice <- lm(mpg~wt*am+qsec+carb, mtcars)
fit_wt_am_all <- lm(mpg~wt*am+., mtcars)
anova(fit_wt, fit_wt_am, fit_wt_am_choice, fit_wt_am_all)
fit_wt<-lm(mpg~wt, mtcars)
fit_wt_am <- lm(mpg~wt*am, mtcars)
fit_all <- lm(mpg~., mtcars)
fit_wt_am_choice <- lm(mpg~wt*am+qsec, mtcars)
fit_wt_am_all <- lm(mpg~wt*am+., mtcars)
anova(fit_wt, fit_wt_am, fit_wt_am_choice, fit_wt_am_all)
fit_wt<-lm(mpg~wt, mtcars)
fit_wt_am <- lm(mpg~wt*am, mtcars)
fit_all <- lm(mpg~., mtcars)
fit_wt_am_choice <- lm(mpg~wt*am+carb, mtcars)
fit_wt_am_all <- lm(mpg~wt*am+., mtcars)
anova(fit_wt, fit_wt_am, fit_wt_am_choice, fit_wt_am_all)
fit_wt<-lm(mpg~wt, mtcars)
fit_wt_am <- lm(mpg~wt*am, mtcars)
fit_all <- lm(mpg~., mtcars)
fit_wt_am_choice <- lm(mpg~wt*am+qsec, mtcars)
fit_wt_am_all <- lm(mpg~wt*am+., mtcars)
anova(fit_wt, fit_wt_am, fit_wt_am_choice, fit_wt_am_all)
fit_wt<-lm(mpg~wt, mtcars)
fit_wt_am <- lm(mpg~wt*am, mtcars)
fit_all <- lm(mpg~., mtcars)
fit_wt_am_qsec1 <- lm(mpg~wt+am+qsec, mtcars)
fit_wt_am_qsec <- lm(mpg~wt*am+qsec, mtcars)
fit_wt_am_all <- lm(mpg~wt*am+., mtcars)
anova(fit_wt, fit_wt_am, fit_wt_am_qsec1, fit_wt_am_qsec, fit_wt_am_all)
fit_wt<-lm(mpg~wt, mtcars)
fit_wt_am <- lm(mpg~wt*am, mtcars)
fit_all <- lm(mpg~., mtcars)
fit_wt_am_qsec1 <- lm(mpg~wt+am+qsec, mtcars)
fit_wt_am_qsec <- lm(mpg~wt*am+qsec, mtcars)
fit_wt_am_all <- lm(mpg~wt*am+., mtcars)
anova(fit_wt, fit_wt_am_qsec1, fit_wt_am, fit_wt_am_qsec, fit_wt_am_all)
summary(fit_wt_am)
summary(fit_wt_am_qsec1)
fit_wt<-lm(mpg~wt, mtcars)
fit_wt_am <- lm(mpg~wt*am, mtcars)
anova(fit_wt, fit_wt_am)
summary(fit_wt)
summary(fit_wt)$coef
fit_wt_am <- lm(mpg~wt*am, mtcars)
summary(fit_wt_am)$coef
library(knitr)
fit_wt<-lm(mpg~wt, mtcars)
kable(summary(fit_wt)$coef)
fit_wt_am <- lm(mpg~wt*am, mtcars)
kable(summary(fit_wt_am)$coef)
kable(anova(fit_wt, fit_wt_am))
summary(fit_wt)
summary(fit_wt_am)
deviance(fit_wt)
rstandard(fit_wt)
summary(fit_wt)
summary(fit_wt)$residual
summary(fit_wt)$rsq
fit_wt
fit_wt[12]
fit_wt[11]
fit_wt[10]
fit_wt[9]
fit_wt[8]
fit_wt[7]
fit_wt[6]
fit_wt[5]
fit_wt[4]
fit_wt[3]
fit_wt[2]
fit_wt[1]
summary(fit_wt)
summary(fit_wt)r.squared
summary(fit_wt)$4r.squared
summary(fit_wt)$r.squared
summary(fit_wt)
summary(fit_wt)$adjusted.r.squared
fit_wt_qsec <- lm(mpg~wt+qsec, mtcars)
summary(fit_wt_qsec)$r.squared
summary(fit_wt_am)$r.squared
kable(anova(fit_wt, fit_wt_qsec, fit_wt_am))
fit_wt_am <- lm(mpg~wt*am, mtcars)
kable(summary(fit_wt_am)$coef)
fit_wt_am_qsec <- lm(mpg~wt*am+qsec, mtcars)
fit_wt_am_all <- lm(mpg~wt*am+., mtcars)
kable(anova(fit_wt, fit_wt_am, fit_wt_am_qsec, fit_wt_am_all))
100*round(summary(fit_wt_am)$r.squared,2)
100*round(summary(fit_wt_am_qsec)$r.squared,2)
100*round(summary(fit_wt_am_all)$r.squared,2)
plot(fit_wt_am_qsec)
?par
par(mfrow=c(2,2))
plot(fit_wt_am_qsec)
par(mfrow=c(2,2))
plot(fit_wt_am_qsec, pch=19)
par(mfrow=c(2,2))
plot(fit_wt_am_qsec, pch=20)
plot(fit_wt_am_qsec, pch=20, col="darkblue")
kable(anova(fit_wt, fit_wt_am, fit_wt_am_qsec, fit_wt_am_all))
a<-anova(fit_wt, fit_wt_am, fit_wt_am_qsec, fit_wt_am_all)
a
a[4]
a[5]
a[6]
a[1,6]
?anova
fit_am <- lm(mpg~am, mtcars)
summary(fit_am)$coeff
summary(fit_am)$coeff[1]
summary(fit_am)$coeff[2]
summary(fit_wt_am_qsec)$coeff[2]
summary(fit_wt_am_qsec)$coeff
summary(fit_wt_am_qsec)$coeff[amManual]
summary(fit_wt_am_qsec)$coeff["amManual"]
summary(fit_wt_am_qsec)$coeff[,1]
summary(fit_wt_am_qsec)$coeff[,1]$amManual
summary(fit_wt_am_qsec)$coeff[3]
summary(fit_wt_am_qsec)$coeff[3,]
summary(fit_wt_am_qsec)$coeff[,3]
summary(fit_wt_am_qsec)$coeff[3]
summary(fit_wt_am_qsec)$coeff
summary(fit_wt_am_qsec)$coeff[3,4]
summary(fit_wt_am_all)$coeff[3,4]
summary(fit_wt_am_all)$coeff
summary(fit_wt_am_qsec)$coeff
summary(fit_wt_am)$coeff
summary(fit_wt_am_qsec)$coeff[3,1]
round(summary(fit_wt_am_qsec)$coeff[3,1],1)
mean(mtcars$wt)
mean(mtcars$qsec)
9.72+17.85-3.8*mean(mtcars$wt)
predict(fit_wt_am_qsec)
plot(mtcars$weight,  predict(fit_wt_am_qsec))
mtcars$weight
mtcars$wt
plot(mtcars$wt,  predict(fit_wt_am_qsec))
qs <- mean(mtcars$qsec)
w  <- mean(mtcars$wt)
coefs <- summary(fit_wt_am_qsec)$coef
coefs
a <- coefs[1]+coefs[2]*w+qs*coefs[4]
m <- coefs[1]+coefs[2]*w+coefs[3]+qs*coefs[4]+w*coefs[5]
a
m
fit_test <- lm(mpg~wt+am+qsec, mtcars)
summary(fit_test)$coef
summary(fit_test)
fit_test <- lm(mpg~wt*qsec+am, mtcars)
summary(fit_test)$coef
summary(fit_wt_am_qsec)$coef
range(mtcars$wt)
w  <- summary(mtcars$wt)
w
range(mtcars$qsec)
qs <- mean(mtcars$qsec)
w  <- summary(mtcars$wt)
coefs <- summary(fit_wt_am_qsec)$coef
a <- coefs[1]+coefs[2]*w+qs*coefs[4]
m <- coefs[1]+coefs[2]*w+coefs[3]+qs*coefs[4]+w*coefs[5]
a
m
par(mfrow=c(2,2))
plot(fit_wt_am_qsec, pch=20, col="darkblue")
hatvalues(fit_wt_am_qsec)
range(hatvalues(fit_wt_am_qsec))
summary(hatvalues(fit_wt_am_qsec))
plot(hatvalues(fit_wt_am_qsec))
bar_plot(hatvalues(fit_wt_am_qsec))
barplot(hatvalues(fit_wt_am_qsec))
barplot(hatvalues(fit_wt_am_qsec))
text(cex=1, x=x-.25, y=-1.25, labs, xpd=TRUE, srt=45, pos=2)
barplot(hatvalues(fit_wt_am_qsec))
text(cex=1, labs, xpd=TRUE, srt=45, pos=2)
barplot(hatvalues(fit_wt_am_qsec))
text(cex=1, labs, xpd=TRUE, srt=45)
barplot(hatvalues(fit_wt_am_qsec))
text(srt=45)
barplot(hatvalues(fit_wt_am_qsec), las=2)
barplot(hatvalues(fit_wt_am_qsec), las=3)
dfbetas(fit_wt_am_qsec)
qs <- mean(mtcars$qsec)
w  <- summary(mtcars$wt)
coefs <- summary(fit_wt_am_qsec)$coef
a <- coefs[1]+coefs[2]*w+qs*coefs[4]
m <- coefs[1]+coefs[2]*w+coefs[3]+qs*coefs[4]+w*coefs[5]
g<-ggplot(data=mtcars,aes(x=wt, y=mpg, color=as.factor(am)))+geom_point(size=3)
g <- g + geom_abline(x=, lwd=1)
qs <- mean(mtcars$qsec)
w  <- summary(mtcars$wt)
coefs <- summary(fit_wt_am_qsec)$coef
coefs <- summary(fit_wt_am_qsec)$coef
a <- coefs[1]+coefs[2]*w+qs*coefs[4]
m <- coefs[1]+coefs[2]*w+coefs[3]+qs*coefs[4]+w*coefs[5]
par(mfrow=c(1,1))
hist(hatvalues(fit_wt_am_qsec))
hist(hatvalues(fit_wt_am_qsec), fill="steelblue")
hist(hatvalues(fit_wt_am_qsec), col="steelblue")
par(mfrow=c(2,2))
plot(fit_wt_am_qsec, pch=20, col="darkblue")
summary(fit_wt)$coef
ggplot(data=mtcars, aes(x=wt, fill=am))+geom_histogram(col=1)
ggplot(data=mtcars, aes(x=wt, fill=am))+geom_histogram(col=1, binwidth=2)
ggplot(data=mtcars, aes(x=wt, fill=am))+geom_histogram(col=1, binwidth=1)
ggplot(data=mtcars, aes(x=wt, fill=am))+geom_histogram(col=1, binwidth=0.5)
ggplot(data=mtcars, aes(x=wt, fill=am))+geom_histogram(col=1, binwidth=0.25)
ggplot(data=mtcars, aes(x=wt, fill=am))+geom_histogram(binwidth=0.25)+ggtitle("Weight distribution")
ggplot(data=mtcars, aes(x=wt, fill=am))+geom_histogram(binwidth=0.25, col=1)+ggtitle("Weight distribution")
